(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{15:function(e,t,a){"use strict";var n=a(11),i=a(1);const s=n.a.Model.extend({urlRoot:"/clients",getIcon:function(){let e;const t=this.get("type");return this.iconClass?this.iconClass:(e=this.id==o.webAppId?"fa fa-cloud":this.id==App.clients.defaultId?"im-pc":t==i.a.CLIENT_FF?"im-firefox":t==i.a.CLIENT_CR?"im-chrome":t==i.a.CLIENT_OP?"im-opera":t==i.a.CLIENT_FFWX?"im-firefox":"im-globe",this.iconClass=e)},getInfo:function(){let e=this.get("info")||this.get("name");return this.id==App.clients.defaultId&&(e+=" (this device)"),e},isWeb:function(){return this.id===o.webAppId}});var o=n.a.Collection.extend({model:s,url:"/clients"},{webAppId:"ffffffff-ffff-ffff-ffff-ffffffffffff"});t.a={Client:s,Clients:o}},32:function(e,t,a){"use strict";var n=a(0),i=a(3),s=a(10),o=a(4);a(15);const l=window.async;if(!l)throw new Error("ADD async");const c=o.a.Base.extend({name:"ClientSelector",tagName:"select",className:"form-control xform-control-sm",onChange:function(){this.model.set("client_id",this.$el.val())},postInit:function(e){this.client_id=this.model.get("client_id")||App.clients.defaultId,this.$el.on("change",this.onChange)},render:function(){return this.$el.append(App.clients.map((function(e){return OPTION({value:e.id},e.getInfo())}))),this.$el.val(this.client_id),this}}),r=o.a.Collection.extend({name:"ClientManager",actions:{"client edit name":{fn:"action_edit_name"},"client remove":{fn:"action_remove"}},action_edit_name:function(e){const t=this,a=s.a.create("text"),n=this.collection.get(e),i=new o.a.PromptModal({title:"l_name",parent:this.getRoot(),view:a,width:500});i.show(),a.setValue(n.get("info")),$(a.field).focus(),i.on("save",(function(){const e=a.getValue();n.save({info:e},{patch:!0}),i.remove(),t.onReset(t.collection,{previousModels:t.collection.models})}))},action_remove:function(e){const t=this.collection.get(e);return e==this.collection.defaultId?alert(Object(n.a)("Can't remove self")):t.isWeb()?alert(Object(n.a)("Can't remove web app")):void(confirm(Object(n.a)("Remove "+t.get("info")+"?"))&&t.save({state:90},{wait:!0,success:()=>{this.collection.remove(t)}}))},addOne:function(e){if(e.get("type")<3)return new o.a.Base;const t=e.get("info"),a=e.id==this.collection.defaultId,i=new o.a.Base({el:P(SPAN(BUTTON({class:"btn btn-default btn-xs","data-action":"client edit name","data-action-param":e.id},I({class:"fa fa-edit"}))," ",BUTTON({class:"btn btn-danger btn-xs","data-action":"client remove","data-action-param":e.id},I({class:"fa fa-trash-o"})))," ",SPAN({style:a?"font-weight: bold;":""},t,a?" ("+Object(n.a)("l_device_this")+")":""),SMALL({},moment(e.get("ts")).format(" (YYYY-MM-DD)"))),parent:this}).render();return this.$el.append(i.el),i},onSave:function(){i.a.info("l_loading"),l.eachSeries(this.collection.models,(function(e,t){e.hasChanged("info")?e.save(null,{error:function(){t(new Error("Failed to save changes"))},success:function(){t()}}):t()}),(function(e){i.a.reset()}))},renderBase:function(){}});t.a={ClientManager:r,ClientSelector:c}},47:function(e,t,a){"use strict";a.r(t);var n=a(31),i=a(0),s=a(50),o=a(2),l=a(14),c=a(3),r=a(4),d=a(6),h=a(15),u=a(38),f=a(10),p=a(1),m=a(8);if(!window.jQuery)throw new Error("ADD jQuery");const b=window._;if(!b)throw new Error("ADD _");if(!window.domo)throw new Error("ADD domo");const g=window.Backbone;if(!g)throw new Error("ADD Backbone");const v=r.a.Base.extend({name:"actions$Common",events:{change:"event_change"},event_change:function(){this.saveValues()},render:function(){return this.$el.attr({id:"common",class:"panel panel-default"}).append(HEADER({class:"panel-heading"},H3(Object(i.a)("l_actions"))),DIV({class:"panel-body"},DIV({class:"checkbox"},LABEL(INPUT({type:"checkbox",name:"actions.popup"}),Object(i.a)("l_action_local_popup"))),DIV({class:"checkbox"},LABEL(INPUT({type:"checkbox",name:"actions.audio"}),Object(i.a)("l_action_local_audio"))),DIV({class:"form-group"},Object(i.a)("m_firefox_only")," - ",Object(i.a)("m_autohide_popup"),": ",SELECT({name:"actions.popup.autohide",style:"width:auto"},OPTION({value:0},Object(i.a)("l_never")),OPTION({value:5},"5s"),OPTION({value:10},"10s"),OPTION({value:20},"20s"),OPTION({value:60},"1m"),OPTION({value:120},"2m"),OPTION({value:300},"5m"))),DIV({class:"alert alert-info"},A({href:"https://distill.io/settings/actions"},Object(i.a)("Change email action settings from web app!"))))),this.setValues(),this},saveValues:function(){this.$el.find("input,select").each((function(){const e=this;"checkbox"==e.type?o.a.store.Prefs.set(e.name,e.checked):o.a.store.Prefs.set(e.name,e.value)}))},setValues:function(){this.$el.find("input,select").each((function(){const e=this;"checkbox"==e.type?e.checked=o.a.store.Prefs.get(e.name):e.value=o.a.store.Prefs.get(e.name)}))}}),w=r.a.Base.extend({name:"Tone",className:"form-group",events:{"click button.xdel":"event_del","click button.xplay":"event_play"},event_del:function(){this.model.collection.remove(this.model)},event_play:function(){"file"==this.model.get("type")?this.playFile():this.playSrc(this.input.getValue())},getDefaultName:function(e){return e.split(/(\/|\\)/).pop()||"New File"},onInputChange:function(){const e=this.input.getValue();b.isEmpty(this.label.getValue())&&this.label.setValue(this.getDefaultName(e))},playFile:function(){this.input.field.files?this.playSelectedFile():this.playSavedFile()},playSavedFile:function(){const e=this,t=this.model.get("value");o.a.store.KVStore.findOne(t,(function(t,a){e.playSrc(a.value)}))},playSelectedFile:function(){const e=this,t=this.input.field.files[0];t?D(t,e.playSrc):alert("Please select an audio file before playing it.")},playSrc:function(e){AUDIO({src:e}).play()},postInit:function(){this.label=f.a.create({model:this.model,param:{label:"l_name",name:"label",type:"text"},parent:this}),this.input=f.a.create({model:this.model,param:"url"==this.model.get("type")?{label:"l_url",type:"url",name:"value"}:null!=this.model.get("value")?{type:"static",name:"value"}:{label:"l_file",type:"file",name:"value"},parent:this}),this.listenTo(this.input,"change",this.onInputChange)},render:function(){return this.$el.append(DIV({class:"col-md-3"},this.label.render().el),DIV({class:"col-md-6"},this.input.render().el),DIV({class:"col-md-3"},BUTTON({class:"btn btn-default xplay"},Object(i.a)("a_play"))," ",BUTTON({class:"btn btn-default xdel"},I({class:"fa fa-times"})))),"file"==this.model.get("type")&&null==this.model.get("value")&&this.input.field.click(),this}}),O=r.a.Base.extend({name:"actions$errorSect",events:{change:"event_change"},event_change:function(){this.saveValues()},render:function(){const e=b.findWhere(m.a.SieveActionDescList,{type:p.a.ACTION_LOCAL_AUDIO}).params[0].list;return console.log(e),this.$el.attr({id:"errorSect",class:"panel panel-default"}).append(HEADER({class:"panel-heading"},H3(Object(i.a)("Error Actions"))),DIV({class:"panel-body"},DIV({class:"checkbox"},LABEL(INPUT({type:"checkbox",name:"errorAction.enabled"}),Object(i.a)("Trigger notifications"))),DIV({class:"form-group"},Object(i.a)("l_notification_sound"),": ",SELECT({name:"errorAction.sound",style:"width:auto"},e.map((function(e,t){return OPTION({value:e.value},Object(i.a)(e.label))})))),DIV({class:"form-group"},Object(i.a)("Minimum time interval between notifications (in minutes): "),INPUT({type:"number",style:"width: 60px;",name:"errorAction.interval",min:"1"})),DIV({class:"form-group"},Object(i.a)("No. of consecutive errors to trigger notifications"),": ",SELECT({name:"errorAction.minCount",style:"width:auto"},OPTION({value:1},"1"),OPTION({value:2},"2"),OPTION({value:3},"3"),OPTION({value:4},"4"),OPTION({value:5},"5"),OPTION({value:6},"6"),OPTION({value:7},"7"),OPTION({value:8},"8"),OPTION({value:9},"9"),OPTION({value:10},"10"))),DIV({class:"alert alert-info"},Object(i.a)("h_error_notif_desc")))),this.setValues(),this},saveValues:function(){this.$el.find("input,select").each((function(){const e=this;"checkbox"==e.type?o.a.store.Prefs.set(e.name,e.checked):o.a.store.Prefs.set(e.name,e.value)}))},setValues:function(){this.$el.find("input,select").each((function(){const e=this;"checkbox"==e.type?e.checked=o.a.store.Prefs.get(e.name):e.value=o.a.store.Prefs.get(e.name)}))}}),y=r.a.Collection.extend({name:"actions$Tones",actions:{"tones add file":{fn:"action_add_file"},"tones add url":{fn:"action_add_url"},"tones save":{fn:"action_save"}},action_add_file:function(){const e=new g.Model({type:"file"});this.collection.add(e)},action_add_url:function(){const e=new g.Model({type:"url"});this.collection.add(e)},action_save:function(){let e;const t=this;function a(e){return b.map(b.filter(e,(function(e){return"file"==e.type})),(function(e){return e.value}))}c.a.start("save","l_loading"),async.mapSeries(b.values(this.views),(function(t,a){const n=t.model.toJSON(),i=t.input.field.files;!!i&&(e=i[0])?D(e,(function(e){const t="tone:"+md5(e);o.a.store.KVStore.create({id:t,value:e},(function(e,i){n.value=t,a(null,n)}))})):a(null,n)}),(function(e,n){async.parallel([function(e){const t=JSON.stringify(n);o.a.store.KVStore.update("tones",{value:t},(function(a,n){0===n?o.a.store.KVStore.create({id:"tones",value:t},e):e()}))},function(e){const i=a(t.oldTones),s=a(n),l=b.difference(i,s);async.each(l,o.a.store.KVStore.destroy,e)}],(function(e){e?c.a.error(Object(i.a)("e_err")+": "+(e.msg||e.message||e)):(c.a.reset(),t.load())}))}))},addOne:function(e){const t=new w({parent:this,model:e}).render();return this.$list.append(t.el),t},initCollection:function(){this.oldTones=[],this.collection=new g.Collection},load:function(e){const t=this;o.a.store.KVStore.findOne("tones",(function(a,n){a?c.a.error("e_err_unexpected"):n&&(t.oldTones=JSON.parse(n.value),t.collection.reset(t.oldTones)),e&&e(a)}))},renderBase:function(){this.$el.attr({id:"tones",class:"panel panel-default"}).append(HEADER({class:"panel-heading clearfix"},H3({class:"pull-left"},"Tones"),DIV({class:"right"},BUTTON({class:"btn btn-default btn-sm","data-action":"tones add file"},Object(i.a)("a_add_file")),BUTTON({class:"btn btn-default btn-sm","data-action":"tones add url"},Object(i.a)("a_add_url")))),DIV({class:"panel-body"},DIV({class:"xlist"})),DIV({class:"panel-footer"},BUTTON({class:"btn btn-primary","data-action":"tones save"},Object(i.a)("a_save")))),this.$list=this.$el.find(".xlist")}});function D(e,t){const a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsDataURL(e)}var T=r.a.ActionProvider.extend({name:"SettingsActions",load:function(e){this.tones.load(e)},postInit:function(){this.common=new v({parent:this}),this.errorSect=new O({parent:this}),this.tones=new y({parent:this})},render:function(){return this.$el.attr({id:"actions",class:"hide"}).append(this.common.render().el,this.errorSect.render().el,this.tones.render().el),this}}),x=a(32);if(!window.jQuery)throw new Error("ADD jQuery");if(!window._)throw new Error("ADD _");var j=r.a.ActionProvider.extend({name:"SettingsClients",events:{"click button":"event_save"},event_save:function(){this.view.onSave()},postInit:function(){this.clients=new h.a.Clients,this.view=new x.a.ClientManager({collection:this.clients,parent:this})},load:function(e){this.clients.fetch({data:{"state.in":[0,30],_opt:{order:["ts"]}},success:e})},render:function(){return this.$el.attr({id:"devices",class:"hide"}).append(DIV({class:"panel panel-default"},HEADER({class:"panel-heading"},H3(Object(i.a)("l_devices"))),DIV({class:"panel-body"},this.view.render().el))),this}});const E=window.jQuery;if(!E)throw new Error("ADD jQuery");if(!window._)throw new Error("ADD _");if(!window.domo)throw new Error("ADD domo");if(!window.Backbone)throw new Error("ADD Backbone");const P=r.a.Base.extend({name:"actions$Common",tagName:"form",events:{change:"event_change"},event_change:function(){this.saveValues()},render:function(){return this.$el.attr({id:"common",class:"panel panel-default"}).append(HEADER({class:"panel-heading"},H3(Object(i.a)("l_advanced"))),DIV({class:"panel-body"},DIV({class:"checkbox"},LABEL(INPUT({type:"checkbox",name:"page.embedded"}),Object(i.a)("m_embedded_opt"))),DIV({class:"form-group"},Object(i.a)("m_max_workers")," ",SELECT({name:"nworkers",style:"width:auto"},OPTION({value:1},1),OPTION({value:2},2),OPTION({value:3},3),OPTION({value:4},4),OPTION({value:5},5),OPTION({value:6},6),OPTION({value:7},7),OPTION({value:8},8),OPTION({value:9},9),OPTION({value:10},10))),DIV({class:"form-group"},Object(i.a)("m_load_page_options")," ",SELECT({name:"x-frame-load-in",style:"width:auto"},OPTION({value:"tab"},Object(i.a)("l_opt_bgtab")),OPTION({value:"window"},Object(i.a)("l_opt_bgwindow")),OPTION({value:"bg"},Object(i.a)("l_opt_force_bg")),OPTION({value:"sticky_window"},Object(i.a)("l_opt_sticky_window")))," ",A({href:"https://distill.io/help/new-tab-chrome-extension"},Object(i.a)("l_learn_more"))),DIV({class:"form-group"},Object(i.a)("m_sticky_window_timeout")," ",INPUT({name:"sticky-window-timeout",type:"number",style:"width:auto"})),DIV({class:"form-group"},DIV({class:"alert alert-info"},Object(i.a)("m_sticky_window_warning"))," "))),this.setValues(),this},saveValues:function(){this.$el.find("input,select").each((function(){const e=this;"checkbox"==e.type?o.a.store.Prefs.set(e.name,e.checked):o.a.store.Prefs.set(e.name,e.value)}))},setValues:function(){this.$el.find("input,select").each((function(){const e=this;"checkbox"==e.type?e.checked=o.a.store.Prefs.get(e.name):e.value=o.a.store.Prefs.get(e.name)}))}}),k=r.a.ActionProvider.extend({name:"SettingsAdvanced",load:function(e){e()},postInit:function(){this.common=new P({parent:this}),this.timing=new V({parent:this})},render:function(){return this.$el.attr({id:"advanced",class:"hide"}).append(this.common.render().el,this.timing.render().el),this}});var V=r.a.Base.extend({name:"TimingSlots",events:{change:"event_change"},postInit:async function(){try{"0"==(await d.a.api("/subscriptions","GET",{"state.in":[40,45]})).data[0].plan_id[0]?E(this.elUnavailable).removeClass("hide"):(E(this.elFormParent).removeClass("hide"),o.a.store.Prefs.get("sieve-slot.enabled")&&E(this.elTimeSlotData).removeClass("hide"))}catch(e){console.log(e),E(this.elUnavailable).removeClass("hide")}},render:function(){return this.$el.attr({id:"errorSect",class:"panel panel-default"}).append(HEADER({class:"panel-heading"},H3(Object(i.a)("l_time_slots"))),DIV({class:"container",style:"width: 100%"},this.elFormParent=DIV({class:"hide"},DIV({class:"row",style:"margin-top: 10px; margin-bottom: 10px;"},DIV({class:"col-sm-12"},DIV({class:"checkbox"},LABEL(this.elSlotEnabled=INPUT({type:"checkbox",name:"sieve-slot.enabled"}),Object(i.a)("l_time_slots_enabled"))))),this.elTimeSlotData=DIV({class:"hide"},DIV({class:"row"},DIV({class:"col-sm-4"},this.formElemStart=DIV({class:"form-group"},Object(i.a)("l_time_slots_start")," ",this.elStartTime=INPUT({name:"sieve-slot.start",type:"time",style:"width: 200px;"}))),DIV({class:"col-sm-4"},this.formElemEnd=DIV({class:"form-group"},Object(i.a)("l_time_slots_end")," ",this.elEndTime=INPUT({name:"sieve-slot.end",type:"time",style:"width: 200px;"}))),DIV({class:"col-sm-4"},this.formElemDays=DIV({class:"form-group"},Object(i.a)("l_time_slots_day")," ",this.elSlotDays=SELECT({name:"sieve-slot.days",id:"slot-days",multiple:!0,style:"width: 200px; height: 120px;"},OPTION({value:1},Object(i.a)("l_monday")),OPTION({value:2},Object(i.a)("l_tuesday")),OPTION({value:3},Object(i.a)("l_wednesday")),OPTION({value:4},Object(i.a)("l_thursday")),OPTION({value:5},Object(i.a)("l_friday")),OPTION({value:6},Object(i.a)("l_saturday")),OPTION({value:0},Object(i.a)("l_sunday")))))),this.elWarningMsg=DIV({class:"form-group"},DIV({class:"alert alert-info"},Object(i.a)("m_day_warning"))," "))),this.elUnavailable=DIV({class:"form-group hide"},DIV({class:"alert alert-info"},Object(i.a)("m_premium_only"))," "))),this.setValues(),this},setValues:function(){this.$el.find("input").each((function(){"checkbox"==this.type?this.checked=o.a.store.Prefs.get(this.name):this.value=o.a.store.Prefs.get(this.name)}));const e=o.a.store.Prefs.get("time-slot-map"),t=Object.keys(e),a=this.$el.find("#slot-days");a.val(t),a.val().length<5?E(this.elWarningMsg).show():E(this.elWarningMsg).hide()},hideForm:function(){E(this.formElemStart).hide(),E(this.formElemEnd).hide(),E(this.formElemDays).hide(),E(this.elWarningMsg).hide()},showForm:function(){E(this.formElemStart).show(),E(this.formElemEnd).show(),E(this.formElemDays).show(),E(this.elWarningMsg).show()},saveValues:function(){this.$el.find("input").each((function(){const e=this;"checkbox"==e.type?o.a.store.Prefs.set(e.name,e.checked):o.a.store.Prefs.set(e.name,e.value)}));const e={},t=this.$el.find("#slot-days").val();for(const a in t){const n=t[a];e[n]=e[n]||[],e[n].push({start:this.elStartTime.value,end:this.elEndTime.value})}o.a.store.Prefs.set("time-slot-map",e)},event_change:function(){const e=this.$el.find("#slot-days");this.elSlotEnabled.checked?E(this.elTimeSlotData).removeClass("hide"):E(this.elTimeSlotData).addClass("hide"),e.val().length<5?E(this.elWarningMsg).show():E(this.elWarningMsg).hide(),this.saveValues()}});var N=k,S=a(55);a(52);const C=window.jQuery;if(!C)throw new Error("ADD jQuery");const $=window.Backbone;if(!$)throw new Error("ADD Backbone");if(!window.async)throw new Error("ADD async");t.default=function(){Object(s.a)();const e={general:u.a.View,actions:T,devices:j,advanced:N};let t;const a={},f=$.Router.extend({routes:{":view":"view"},view:function(n){t&&t.$el.addClass("hide");const i=e[n];if(!i)throw new Error("Unknown setting class:"+n);(t=a[n])||(t=a[n]=new i({parent:p}),p.body.appendChild(t.render().el)),t.load?(c.a.start("load "+n,{info:"l_loading"}),t.load((function(){c.a.stop("load "+n),t.$el.removeClass("hide")}))):t.$el.removeClass("hide"),C("#sidebar a").removeClass("active").parent().find("a[data-action-param="+n+"]").addClass("active")}});var p=new(r.a.RoutedRoot.extend({render:function(){return this.$el.append(DIV({class:"row"},DIV({class:"col-md-3"},DIV({id:"sidebar",class:"list-group"},A({class:"list-group-item",href:"#general","data-action-param":"general"},Object(i.a)("l_general"),I({class:"fa fa-chevron-right right"})),A({class:"list-group-item",href:"#actions","data-action-param":"actions"},Object(i.a)("l_actions"),I({class:"fa fa-chevron-right right"})),A({class:"list-group-item",href:"#devices","data-action-param":"devices"},Object(i.a)("l_devices"),I({class:"fa fa-chevron-right right"})),A({class:"list-group-item",href:"https://distill.io/settings/emails_phones"},Object(i.a)("l_emails_phones"),I({class:"fa fa-chevron-right right"})),A({class:"list-group-item",href:"#advanced","data-action-param":"advanced"},Object(i.a)("l_advanced"),I({class:"fa fa-chevron-right right"})))),this.body=DIV({class:"col-md-9"}))),this}}))({el:C("#content")[0]}).render();C("<div id='x-vsidebar'></div>").appendTo(document.body),Object(n.b)(Object(S.a)(),document.getElementById("x-vsidebar")),C("#x-vsidebar").find('[data-toggle="tooltip"]').tooltip({placement:"right"}),C("#x-vsidebar").find(".vbar-tooltip").tooltip({placement:"right"}),window.App=new f,App.clients=new h.a.Clients,App.clients.defaultId=o.a.store.Prefs.get("client.id"),p.on("child:add child:remove",_.debounce((function(){l.a.Acts.setActions(p.getActions())}),100)),C((function(){d.a.init((function(e,t){if(e)throw c.a.stop("init",{error:{msg:"err:api_load"}}),new Error("Failed to init api subsystem:"+e);c.a.stop("init"),App.clients.fetch({data:{"state.in":[0,30],_opt:{order:["ts"]}}}),$.history.start({root:ROUTE_ROOT,pushState:PUSH_STATE}),c.a.showHelp()}))}))}},50:function(e,t,a){"use strict";var n=a(0);const i=window.jQuery;if(!i)throw new Error("ADD jQuery");t.a=function(){i("[data-placeholder]").each((function(){this.placeholder=Object(n.a)(this.getAttribute("data-placeholder"))})),i("[data-text]").each((function(){this.textContent=Object(n.a)(this.getAttribute("data-text"))})),i("[data-title]").each((function(){this.title=Object(n.a)(this.getAttribute("data-title"))}))}},52:function(e,t,a){"use strict";const n=a(2).a.CFG.URL.ROOT;t.a={api:`${n}/api/v1`,static:"/ui",error_reporter:"https://reporter.distillweb.net",error_reporter_local:"error-reporter-local",website:"https://distill.io",watchlist:"/ui/inbox.html#inbox",template:"/ui/inbox.html#tpls",availability:`${n}/analytics/availability`,settings:"/ui/settings.html#general",billing:`${n}/settings/billing`,login:`${n}/service-login?redirect=app://ui/inbox.html#inbox`,logout:`${n}/logout`}},53:function(e,t,a){"use strict";var n=a(0),i=a(4),s=a(6);const o=window._;if(!o)throw new Error("ADD _");const l=window.Backbone;if(!l)throw new Error("ADD Backbone");const c=window.jQuery;if(!c)throw new Error("ADD jQuery");if(!window.domo)throw new Error("ADD domo");const r=i.a.Base.extend({name:"FeedbackForm",events:{"click button":"send_feedback","change input":"event_change","keypress textarea":"event_change"},event_change:function(e){o.defer(()=>{let{name:t,value:a}=e.target;a=a.trim(),this.model.set(t,a)})},send_feedback:function(e){e.preventDefault();const t=this.model.get("message"),a=this.model.get("emotion"),n=document.URL;t&&(s.a.api("/feedbacks","POST",{message:t,emotion:a,context:n},(function(e){})),c(this.form).addClass("hide").removeClass("form"),c(this.success).removeClass("hide"),window.setTimeout(()=>{this.hide()},2e3),this.model.set({message:"",emotion:"😀"}))},hide:function(){c(window).off("mousedown",this.onAClick).off("keypress",this.onKeyup),this.remove()},removeChildren:function(){o.each(this.children.slice(0),(function(e){e.remove(),this.trigger("child:remove")}),this)},onAClick:function(e){const t=e.target;!c.contains(document.documentElement,t)&&document.documentElement!=t||c.contains(this.form,t)||this.hide()},onKeyup:function(e){console.log(e.keyCode),27==e.keyCode&&this.hide()},postInit:function(){o.defer((function(e){c(window).mousedown(e.onAClick).keyup(e.onKeyup)}),this)},render:function(){return this.$el.append(DIV({class:"popover",style:"display: flex;\n        flex-wrap:wrap;\n        text-align:center;\n        top: auto;\n        left: 60px;\n        bottom: 50px;\n        width: 300px"},this.form=FORM({class:"form",role:"form"},TEXTAREA({type:"text",name:"message",placeholder:Object(n.a)("m_send_feedback"),style:"width: 100%; height: 120px; padding: 5px 10px 10px"},this.model.get("message")||""),DIV({style:"margin:0px 0px 2px 0px; width:auto;",class:"btn-group btn-group-toggle","data-toggle":"buttons"},o.map([{emo:"😀",title:Object(n.a)("l_happy")},{emo:"🤔",title:Object(n.a)("l_suggestion")},{emo:"☹",title:Object(n.a)("l_sad")},{emo:"🙄",title:Object(n.a)("l_confused")},{emo:"😡",title:Object(n.a)("l_dissatisfied")}],e=>LABEL({class:"btn btn-secondary "+(e.emo==this.model.get("emotion")?"active":""),title:e.title},INPUT({type:"radio",value:e.emo,name:"emotion"}),e.emo))),BUTTON({type:"submit",class:"btn btn-primary pull-right ",style:"min-width:0"},Object(n.a)("a_send"))),this.success=DIV({class:"hide",style:"width:100%; ma-width: 30%; margin:20% 30%; "},Object(n.a)("m_thank_you"),"       😀"))),this.focus(),this}}),d=i.a.Base.extend({name:"FeedbackAnchor",events:{"click a":"event_click"},postInit:function(){this.model=new l.Model({emotion:"😀"})},event_click:function(){const e=new r({model:this.model,parent:this}).render();c(this.popoverCt).append(e.el)},render:function(){return this.$el.append(A({class:"ripple",id:"feedAnchor",href:"#","data-toggle":"tooltip","data-html":"true",title:"<b>Feedback</b>"},I({class:"fa fa-comment","aria-hidden":"true"})),this.popoverCt=DIV({id:"feedPop"})),this}});t.a={FeedbackAnchor:d}},54:function(e,t,a){"use strict";var n=a(2),i=(a(0),a(5)),s=a(4),o=[{locale:"en-US",label:"English (US)"},{locale:"de",label:"Deutsch"},{locale:"fr",label:"Français"},{locale:"ru",label:"Русский"},{locale:"ja",label:"日本語"},{locale:"zh",label:"简体中文"},{locale:"es",label:"Español"},{locale:"it",label:"Italiano"},{locale:"pl",label:"Polskie"},{locale:"pt",label:"Português do Brasil"},{locale:"sr",label:"Српски"}],l=a(6);const c=window._;if(!c)throw new Error("ADD _");if(!window.jQuery)throw new Error("ADD jQuery");const r=window.location,d=s.a.Dropdown.extend({getLocale:function(){return USER&&USER.locale||LOCALE},getLabel:function(e){return c.findWhere(o,{locale:e}).label},postInit:function(e){this.menu=new s.a.Menu({items:c.map(o,(function(e){return{label:e.label,data:{locale:e.locale}}}))}),this.menu.on("click",this.onClick),this.setLabel(""),this.$el.attr({"data-toggle":"tooltip","data-html":"true",title:"<b>Language</b>"})},onClick:function(e){const t=e.locale;if(i.a.agents.local){const e=n.a.auth.getId();n.a.store.Prefs.set("locale",t),e?l.a.api("/users","PUT",{id:e,locale:t},(function(){n.a.service.SyncMan._syncStore(n.a.store.UserStore,(function(){r.reload()}))})):r.reload()}else USER&&l.a.api("/users","PUT",{locale:t},(function(){r.reload()}));return!0},renderAction:function(){return A({class:"ripple vbar-tooltip",href:"#","data-toggle":"dropdown","data-html":"true"},I({class:"fa fa-language","aria-hidden":"true"}))}});t.a=d},55:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(2),i=a(5),s=a(13),o=a(53),l=a(54),c=a(0),r=a(52);let d,h,u,f,p,m,b=e=>e;window._;if(!window.jQuery)throw new Error("ADD jQuery");const g=(new l.a).render(),v=(new o.a.FeedbackAnchor).render();function w(e){i.a.agents.local&&(e.preventDefault(),n.a.auth.logout(),location.href=r.a.logout)}function O(){return Object(s.b)(d||(d=b`
    <div class='vbar'>
        <a class='xripple xside-logo' target="_blank" rel="noopener" href='${0}' data-toggle="tooltip" data-html="true" title="<b>Distill.io</b>"><img height=38 alt='distill-logo' src='${0}/img/distill_logo_inverted.svg'/></a>
        <a class='xripple' href='${0}' data-toggle="tooltip" data-html="true" title="<b>Watchlist</b>"><i class="fa fa-list" aria-hidden="true"></i></a>
        <a class='xripple' href='${0}' data-toggle="tooltip" data-html="true" title="<b>Analytics</b>"><i class="fa fa-bar-chart-o" aria-hidden="true"></i></a>
        <a class='xripple' href='${0}' data-toggle="tooltip" data-html="true" title="<b>Templates</b>"><i class="fa fa-file-text" aria-hidden="true"></i></a>
        ${0}
        <i style='flex: 1'></i>
        ${0}
        ${0}
        <div class='dropdown' data-toggle="tooltip" data-html="true" title="<b>Settings</b>">
            <a class='xripple vbar-tooltip dropdown-toggle' data-toggle="dropdown" href='#'>
              <i class="fa fa-cog" aria-hidden="true"></i>
            </a>
            <ul class='dropdown-menu' role='menu'>
              ${0}
              <li class='divider'></li>
              <li><a target="_blank" rel="noopener" href="https://distill.io/kb/">${0}</a></li>
              <li role='presentation'><a href="${0}" role='menuitem'>${0}</a></li>
              ${0}
              ${0}
            </ul>
        </div>
    </div>
  `),r.a.website,r.a.static,r.a.watchlist,r.a.availability,r.a.template,USER.account_id?Object(s.b)(h||(h=b`
            <a class='xripple' href='/groups/' data-toggle="tooltip" data-html="true" title="<b>Manage Teams</b>">
              <i class="fa fa-users" aria-hidden="true"></i>
            </a>`)):"",v.el,g.el,USER.name?Object(s.b)(u||(u=b`
                  <li class='logout' role='presentation'><a href=${0} @click=${0} role='menuitem'>${0} (<em>${0}</em>)</a></li>
                `),r.a.logout,w,Object(c.a)("a_sign_out"),USER.name):Object(s.b)(f||(f=b`
                  <li class='login' role='presentation'><a href=${0} role='menuitem'>${0}</a></li>
                `),r.a.login,Object(c.a)("a_signin")),Object(c.a)("l_support"),r.a.settings,Object(c.a)("l_settings"),USER.account_id?"":Object(s.b)(p||(p=b`<li role='presentation'><a href="${0}" target="_blank" role='menuitem'>${0}</a></li>`),r.a.billing,Object(c.a)("l_billing")),"admin"==USER.role?Object(s.b)(m||(m=b`<li role='presentation'><a href="/admin/users" role='menuitem'>${0}</a></li>`),Object(c.a)("l_admin")):"")}}}]);
//# sourceMappingURL=11.js.map