(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{21:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(43),i=a.n(n),o=a(44),s=a.n(o),l=a(42);a.d(t,"b",(function(){return l.a})),a.d(t,"c",(function(){return l.b}));var r=function(){function e(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;i()(this,e),Object.assign(this,n),this.el=this.el||document.createElement(this.tag),this.el.setAttribute("viewclass",this._getCName()),this.state=new Proxy(a,{set:function(e,a,n){return e[a]!==n&&(e[a]=n,!t._renderTimeout&&t._render()),!0},deleteProperty:function(e,a){return a in e&&(delete e[a],!t._renderTimeout&&t._render(),!0)}}),this.views=new Proxy({},{set:function(e,a,n){return e[a]!==n&&(e[a]=n,t._render()),!0}}),this.init(),this._render()}return s()(e,[{key:"createTpl",value:function(){throw new Error("View should implement createTpl(state)")}},{key:"init",value:function(){}},{key:"_render",value:function(){var e=this;this._renderTimeout&&clearTimeout(this._renderTimeout),this._renderTimeout=setTimeout((function(){delete e._renderTimeout,Object(l.b)(e.createTpl(e.state),e.el),e.afterRender()}),1)}},{key:"afterRender",value:function(){}},{key:"setState",value:function(e){for(var t in e)this.state[t]!==e[t]&&(this.state[t]=e[t])}},{key:"_getCName",value:function(){return this.constructor.name}}]),e}();r.prototype.tag="div"},26:function(e,t,a){"use strict";var n=a(16),i=a(1),o=n.a.Model.extend({urlRoot:"/clients",getIcon:function(){var e,t=this.get("type");return this.iconClass?this.iconClass:(e=this.id==s.webAppId?"fa fa-cloud":this.id==App.clients.defaultId?"im-pc":t==i.a.CLIENT_FF?"im-firefox":t==i.a.CLIENT_CR?"im-chrome":t==i.a.CLIENT_OP?"im-opera":t==i.a.CLIENT_FFWX?"im-firefox":"im-globe",this.iconClass=e)},getInfo:function(){var e=this.get("info")||this.get("name");return this.id==App.clients.defaultId&&(e+=" (this device)"),e},isWeb:function(){return this.id===s.webAppId}}),s=n.a.Collection.extend({model:o,url:"/clients"},{webAppId:"ffffffff-ffff-ffff-ffff-ffffffffffff"});t.a={Client:o,Clients:s}},45:function(e,t,a){"use strict";var n=a(0),i=a(3),o=a(14),s=a(4),l=(a(26),window.async);if(!l)throw new Error("ADD async");var r=s.a.Base.extend({name:"ClientSelector",tagName:"select",className:"form-control xform-control-sm",onChange:function(){this.model.set("client_id",this.$el.val())},postInit:function(e){this.client_id=this.model.get("client_id")||App.clients.defaultId,this.$el.on("change",this.onChange)},render:function(){return this.$el.append(App.clients.map((function(e){return OPTION({value:e.id},e.getInfo())}))),this.$el.val(this.client_id),this}}),c=s.a.Collection.extend({name:"ClientManager",actions:{"client edit name":{fn:"action_edit_name"},"client remove":{fn:"action_remove"}},action_edit_name:function(e){var t=this,a=o.a.create("text"),n=this.collection.get(e),i=new s.a.PromptModal({title:"l_name",parent:this.getRoot(),view:a,width:500});i.show(),a.setValue(n.get("info")),$(a.field).focus(),i.on("save",(function(){var e=a.getValue();n.save({info:e},{patch:!0}),i.remove(),t.onReset(t.collection,{previousModels:t.collection.models})}))},action_remove:function(e){var t=this,a=this.collection.get(e);return e==this.collection.defaultId?alert(Object(n.a)("Can't remove self")):a.isWeb()?alert(Object(n.a)("Can't remove web app")):void(confirm(Object(n.a)("Remove "+a.get("info")+"?"))&&a.save({state:90},{wait:!0,success:function(){t.collection.remove(a)}}))},addOne:function(e){if(e.get("type")<3)return new s.a.Base;var t=e.get("info"),a=e.id==this.collection.defaultId,i=new s.a.Base({el:P(SPAN(BUTTON({class:"btn btn-default btn-xs","data-action":"client edit name","data-action-param":e.id},I({class:"fa fa-edit"}))," ",BUTTON({class:"btn btn-danger btn-xs","data-action":"client remove","data-action-param":e.id},I({class:"fa fa-trash-o"})))," ",SPAN({style:a?"font-weight: bold;":""},t,a?" ("+Object(n.a)("l_device_this")+")":""),SMALL({},moment(e.get("ts")).format(" (YYYY-MM-DD)"))),parent:this}).render();return this.$el.append(i.el),i},onSave:function(){i.a.info("l_loading"),l.eachSeries(this.collection.models,(function(e,t){e.hasChanged("info")?e.save(null,{error:function(){t(new Error("Failed to save changes"))},success:function(){t()}}):t()}),(function(e){i.a.reset()}))},renderBase:function(){}});t.a={ClientManager:c,ClientSelector:r}},69:function(e,t,a){"use strict";a.r(t);var n=a(42),i=a(0),o=a(72),s=a(2),l=a(22),r=a(3),c=a(4),d=a(10),u=a(26),h=a(55),f=a(14),p=a(1),m=a(12);if(!window.jQuery)throw new Error("ADD jQuery");var v=window._;if(!v)throw new Error("ADD _");if(!window.domo)throw new Error("ADD domo");var b=window.Backbone;if(!b)throw new Error("ADD Backbone");var g=c.a.Base.extend({name:"actions$Common",events:{change:"event_change"},event_change:function(){this.saveValues()},render:function(){return this.$el.attr({id:"common",class:"panel panel-default"}).append(HEADER({class:"panel-heading"},H3(Object(i.a)("l_actions"))),DIV({class:"panel-body"},DIV({class:"checkbox"},LABEL(INPUT({type:"checkbox",name:"actions.popup"}),Object(i.a)("l_action_local_popup"))),DIV({class:"checkbox"},LABEL(INPUT({type:"checkbox",name:"actions.audio"}),Object(i.a)("l_action_local_audio"))),DIV({class:"form-group"},Object(i.a)("m_firefox_only")," - ",Object(i.a)("m_autohide_popup"),": ",SELECT({name:"actions.popup.autohide",style:"width:auto"},OPTION({value:0},Object(i.a)("l_never")),OPTION({value:5},"5s"),OPTION({value:10},"10s"),OPTION({value:20},"20s"),OPTION({value:60},"1m"),OPTION({value:120},"2m"),OPTION({value:300},"5m"))),DIV({class:"alert alert-info"},A({href:"https://distill.io/settings/actions"},Object(i.a)("Change email action settings from web app!"))))),this.setValues(),this},saveValues:function(){this.$el.find("input,select").each((function(){var e=this;"checkbox"==e.type?s.a.store.Prefs.set(e.name,e.checked):s.a.store.Prefs.set(e.name,e.value)}))},setValues:function(){this.$el.find("input,select").each((function(){var e=this;"checkbox"==e.type?e.checked=s.a.store.Prefs.get(e.name):e.value=s.a.store.Prefs.get(e.name)}))}}),w=c.a.Base.extend({name:"Tone",className:"form-group",events:{"click button.xdel":"event_del","click button.xplay":"event_play"},event_del:function(){this.model.collection.remove(this.model)},event_play:function(){"file"==this.model.get("type")?this.playFile():this.playSrc(this.input.getValue())},getDefaultName:function(e){return e.split(/(\/|\\)/).pop()||"New File"},onInputChange:function(){var e=this.input.getValue();v.isEmpty(this.label.getValue())&&this.label.setValue(this.getDefaultName(e))},playFile:function(){this.input.field.files?this.playSelectedFile():this.playSavedFile()},playSavedFile:function(){var e=this,t=this.model.get("value");s.a.store.KVStore.findOne(t,(function(t,a){e.playSrc(a.value)}))},playSelectedFile:function(){var e=this.input.field.files[0];e?D(e,this.playSrc):alert("Please select an audio file before playing it.")},playSrc:function(e){AUDIO({src:e}).play()},postInit:function(){this.label=f.a.create({model:this.model,param:{label:"l_name",name:"label",type:"text"},parent:this}),this.input=f.a.create({model:this.model,param:"url"==this.model.get("type")?{label:"l_url",type:"url",name:"value"}:null!=this.model.get("value")?{type:"static",name:"value"}:{label:"l_file",type:"file",name:"value"},parent:this}),this.listenTo(this.input,"change",this.onInputChange)},render:function(){return this.$el.append(DIV({class:"col-md-3"},this.label.render().el),DIV({class:"col-md-6"},this.input.render().el),DIV({class:"col-md-3"},BUTTON({class:"btn btn-default xplay"},Object(i.a)("a_play"))," ",BUTTON({class:"btn btn-default xdel"},I({class:"fa fa-times"})))),"file"==this.model.get("type")&&null==this.model.get("value")&&this.input.field.click(),this}}),O=c.a.Base.extend({name:"actions$errorSect",events:{change:"event_change"},event_change:function(){this.saveValues()},render:function(){var e=v.findWhere(m.a.SieveActionDescList,{type:p.a.ACTION_LOCAL_AUDIO}).params[0].list;return console.log(e),this.$el.attr({id:"errorSect",class:"panel panel-default"}).append(HEADER({class:"panel-heading"},H3(Object(i.a)("Error Actions"))),DIV({class:"panel-body"},DIV({class:"checkbox"},LABEL(INPUT({type:"checkbox",name:"errorAction.enabled"}),Object(i.a)("Trigger notifications"))),DIV({class:"form-group"},Object(i.a)("l_notification_sound"),": ",SELECT({name:"errorAction.sound",style:"width:auto"},e.map((function(e,t){return OPTION({value:e.value},Object(i.a)(e.label))})))),DIV({class:"form-group"},Object(i.a)("Minimum time interval between notifications (in minutes): "),INPUT({type:"number",style:"width: 60px;",name:"errorAction.interval",min:"1"})),DIV({class:"form-group"},Object(i.a)("No. of consecutive errors to trigger notifications"),": ",SELECT({name:"errorAction.minCount",style:"width:auto"},OPTION({value:1},"1"),OPTION({value:2},"2"),OPTION({value:3},"3"),OPTION({value:4},"4"),OPTION({value:5},"5"),OPTION({value:6},"6"),OPTION({value:7},"7"),OPTION({value:8},"8"),OPTION({value:9},"9"),OPTION({value:10},"10"))),DIV({class:"alert alert-info"},Object(i.a)("h_error_notif_desc")))),this.setValues(),this},saveValues:function(){this.$el.find("input,select").each((function(){var e=this;"checkbox"==e.type?s.a.store.Prefs.set(e.name,e.checked):s.a.store.Prefs.set(e.name,e.value)}))},setValues:function(){this.$el.find("input,select").each((function(){var e=this;"checkbox"==e.type?e.checked=s.a.store.Prefs.get(e.name):e.value=s.a.store.Prefs.get(e.name)}))}}),y=c.a.Collection.extend({name:"actions$Tones",actions:{"tones add file":{fn:"action_add_file"},"tones add url":{fn:"action_add_url"},"tones save":{fn:"action_save"}},action_add_file:function(){var e=new b.Model({type:"file"});this.collection.add(e)},action_add_url:function(){var e=new b.Model({type:"url"});this.collection.add(e)},action_save:function(){var e,t=this;function a(e){return v.map(v.filter(e,(function(e){return"file"==e.type})),(function(e){return e.value}))}r.a.start("save","l_loading"),async.mapSeries(v.values(this.views),(function(t,a){var n=t.model.toJSON(),i=t.input.field.files;!!i&&(e=i[0])?D(e,(function(e){var t="tone:"+md5(e);s.a.store.KVStore.create({id:t,value:e},(function(e,i){n.value=t,a(null,n)}))})):a(null,n)}),(function(e,n){async.parallel([function(e){var t=JSON.stringify(n);s.a.store.KVStore.update("tones",{value:t},(function(a,n){0===n?s.a.store.KVStore.create({id:"tones",value:t},e):e()}))},function(e){var i=a(t.oldTones),o=a(n),l=v.difference(i,o);async.each(l,s.a.store.KVStore.destroy,e)}],(function(e){e?r.a.error(Object(i.a)("e_err")+": "+(e.msg||e.message||e)):(r.a.reset(),t.load())}))}))},addOne:function(e){var t=new w({parent:this,model:e}).render();return this.$list.append(t.el),t},initCollection:function(){this.oldTones=[],this.collection=new b.Collection},load:function(e){var t=this;s.a.store.KVStore.findOne("tones",(function(a,n){a?r.a.error("e_err_unexpected"):n&&(t.oldTones=JSON.parse(n.value),t.collection.reset(t.oldTones)),e&&e(a)}))},renderBase:function(){this.$el.attr({id:"tones",class:"panel panel-default"}).append(HEADER({class:"panel-heading clearfix"},H3({class:"pull-left"},"Tones"),DIV({class:"right"},BUTTON({class:"btn btn-default btn-sm","data-action":"tones add file"},Object(i.a)("a_add_file")),BUTTON({class:"btn btn-default btn-sm","data-action":"tones add url"},Object(i.a)("a_add_url")))),DIV({class:"panel-body"},DIV({class:"xlist"})),DIV({class:"panel-footer"},BUTTON({class:"btn btn-primary","data-action":"tones save"},Object(i.a)("a_save")))),this.$list=this.$el.find(".xlist")}});function D(e,t){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.readAsDataURL(e)}var T=c.a.ActionProvider.extend({name:"SettingsActions",load:function(e){this.tones.load(e)},postInit:function(){this.common=new g({parent:this}),this.errorSect=new O({parent:this}),this.tones=new y({parent:this})},render:function(){return this.$el.attr({id:"actions",class:"hide"}).append(this.common.render().el,this.errorSect.render().el,this.tones.render().el),this}}),x=a(45);if(!window.jQuery)throw new Error("ADD jQuery");if(!window._)throw new Error("ADD _");var j=c.a.ActionProvider.extend({name:"SettingsClients",events:{"click button":"event_save"},event_save:function(){this.view.onSave()},postInit:function(){this.clients=new u.a.Clients,this.view=new x.a.ClientManager({collection:this.clients,parent:this})},load:function(e){this.clients.fetch({data:{"state.in":[0,30],_opt:{order:["ts"]}},success:e})},render:function(){return this.$el.attr({id:"devices",class:"hide"}).append(DIV({class:"panel panel-default"},HEADER({class:"panel-heading"},H3(Object(i.a)("l_devices"))),DIV({class:"panel-body"},this.view.render().el))),this}}),E=a(5),P=a.n(E),k=a(7),V=a.n(k),N=window.jQuery;if(!N)throw new Error("ADD jQuery");if(!window._)throw new Error("ADD _");if(!window.domo)throw new Error("ADD domo");if(!window.Backbone)throw new Error("ADD Backbone");var S,C=c.a.Base.extend({name:"actions$Common",tagName:"form",events:{change:"event_change"},event_change:function(){this.saveValues()},render:function(){return this.$el.attr({id:"common",class:"panel panel-default"}).append(HEADER({class:"panel-heading"},H3(Object(i.a)("l_advanced"))),DIV({class:"panel-body"},DIV({class:"checkbox"},LABEL(INPUT({type:"checkbox",name:"page.embedded"}),Object(i.a)("m_embedded_opt"))),DIV({class:"form-group"},Object(i.a)("m_max_workers")," ",SELECT({name:"nworkers",style:"width:auto"},OPTION({value:1},1),OPTION({value:2},2),OPTION({value:3},3),OPTION({value:4},4),OPTION({value:5},5),OPTION({value:6},6),OPTION({value:7},7),OPTION({value:8},8),OPTION({value:9},9),OPTION({value:10},10))),DIV({class:"form-group"},Object(i.a)("m_load_page_options")," ",SELECT({name:"x-frame-load-in",style:"width:auto"},OPTION({value:"tab"},Object(i.a)("l_opt_bgtab")),OPTION({value:"window"},Object(i.a)("l_opt_bgwindow")),OPTION({value:"bg"},Object(i.a)("l_opt_force_bg")),OPTION({value:"sticky_window"},Object(i.a)("l_opt_sticky_window")))," ",A({href:"https://distill.io/help/new-tab-chrome-extension"},Object(i.a)("l_learn_more"))),DIV({class:"form-group"},Object(i.a)("m_sticky_window_timeout")," ",INPUT({name:"sticky-window-timeout",type:"number",style:"width:auto"})),DIV({class:"form-group"},DIV({class:"alert alert-info"},Object(i.a)("m_sticky_window_warning"))," "))),this.setValues(),this},saveValues:function(){this.$el.find("input,select").each((function(){var e=this;"checkbox"==e.type?s.a.store.Prefs.set(e.name,e.checked):s.a.store.Prefs.set(e.name,e.value)}))},setValues:function(){this.$el.find("input,select").each((function(){var e=this;"checkbox"==e.type?e.checked=s.a.store.Prefs.get(e.name):e.value=s.a.store.Prefs.get(e.name)}))}}),U=c.a.ActionProvider.extend({name:"SettingsAdvanced",load:function(e){e()},postInit:function(){this.common=new C({parent:this}),this.timing=new $({parent:this})},render:function(){return this.$el.attr({id:"advanced",class:"hide"}).append(this.common.render().el,this.timing.render().el),this}}),$=c.a.Base.extend({name:"TimingSlots",events:{change:"event_change"},postInit:(S=V()(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.api("/subscriptions","GET",{"state.in":[40,45]});case 3:"0"==e.sent.data[0].plan_id[0]?N(this.elUnavailable).removeClass("hide"):(N(this.elFormParent).removeClass("hide"),s.a.store.Prefs.get("sieve-slot.enabled")&&N(this.elTimeSlotData).removeClass("hide")),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),N(this.elUnavailable).removeClass("hide");case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return S.apply(this,arguments)}),render:function(){return this.$el.attr({id:"errorSect",class:"panel panel-default"}).append(HEADER({class:"panel-heading"},H3(Object(i.a)("l_time_slots"))),DIV({class:"container",style:"width: 100%"},this.elFormParent=DIV({class:"hide"},DIV({class:"row",style:"margin-top: 10px; margin-bottom: 10px;"},DIV({class:"col-sm-12"},DIV({class:"checkbox"},LABEL(this.elSlotEnabled=INPUT({type:"checkbox",name:"sieve-slot.enabled"}),Object(i.a)("l_time_slots_enabled"))))),this.elTimeSlotData=DIV({class:"hide"},DIV({class:"row"},DIV({class:"col-sm-4"},this.formElemStart=DIV({class:"form-group"},Object(i.a)("l_time_slots_start")," ",this.elStartTime=INPUT({name:"sieve-slot.start",type:"time",style:"width: 200px;"}))),DIV({class:"col-sm-4"},this.formElemEnd=DIV({class:"form-group"},Object(i.a)("l_time_slots_end")," ",this.elEndTime=INPUT({name:"sieve-slot.end",type:"time",style:"width: 200px;"}))),DIV({class:"col-sm-4"},this.formElemDays=DIV({class:"form-group"},Object(i.a)("l_time_slots_day")," ",this.elSlotDays=SELECT({name:"sieve-slot.days",id:"slot-days",multiple:!0,style:"width: 200px; height: 120px;"},OPTION({value:1},Object(i.a)("l_monday")),OPTION({value:2},Object(i.a)("l_tuesday")),OPTION({value:3},Object(i.a)("l_wednesday")),OPTION({value:4},Object(i.a)("l_thursday")),OPTION({value:5},Object(i.a)("l_friday")),OPTION({value:6},Object(i.a)("l_saturday")),OPTION({value:0},Object(i.a)("l_sunday")))))),this.elWarningMsg=DIV({class:"form-group"},DIV({class:"alert alert-info"},Object(i.a)("m_day_warning"))," "))),this.elUnavailable=DIV({class:"form-group hide"},DIV({class:"alert alert-info"},Object(i.a)("m_premium_only"))," "))),this.setValues(),this},setValues:function(){this.$el.find("input").each((function(){"checkbox"==this.type?this.checked=s.a.store.Prefs.get(this.name):this.value=s.a.store.Prefs.get(this.name)}));var e=s.a.store.Prefs.get("time-slot-map"),t=Object.keys(e),a=this.$el.find("#slot-days");a.val(t),a.val().length<5?N(this.elWarningMsg).show():N(this.elWarningMsg).hide()},hideForm:function(){N(this.formElemStart).hide(),N(this.formElemEnd).hide(),N(this.formElemDays).hide(),N(this.elWarningMsg).hide()},showForm:function(){N(this.formElemStart).show(),N(this.formElemEnd).show(),N(this.formElemDays).show(),N(this.elWarningMsg).show()},saveValues:function(){this.$el.find("input").each((function(){var e=this;"checkbox"==e.type?s.a.store.Prefs.set(e.name,e.checked):s.a.store.Prefs.set(e.name,e.value)}));var e={},t=this.$el.find("#slot-days").val();for(var a in t){var n=t[a];e[n]=e[n]||[],e[n].push({start:this.elStartTime.value,end:this.elEndTime.value})}s.a.store.Prefs.set("time-slot-map",e)},event_change:function(){var e=this.$el.find("#slot-days");this.elSlotEnabled.checked?N(this.elTimeSlotData).removeClass("hide"):N(this.elTimeSlotData).addClass("hide"),e.val().length<5?N(this.elWarningMsg).show():N(this.elWarningMsg).hide(),this.saveValues()}});var B=U,L=a(79),R=(a(76),window.jQuery);if(!R)throw new Error("ADD jQuery");var F=window.Backbone;if(!F)throw new Error("ADD Backbone");if(!window.async)throw new Error("ADD async");t.default=function(){Object(o.a)();var e,t={general:h.a.View,actions:T,devices:j,advanced:B},a={},f=F.Router.extend({routes:{":view":"view"},view:function(n){e&&e.$el.addClass("hide");var i=t[n];if(!i)throw new Error("Unknown setting class:"+n);(e=a[n])||(e=a[n]=new i({parent:p}),p.body.appendChild(e.render().el)),e.load?(r.a.start("load "+n,{info:"l_loading"}),e.load((function(){r.a.stop("load "+n),e.$el.removeClass("hide")}))):e.$el.removeClass("hide"),R("#sidebar a").removeClass("active").parent().find("a[data-action-param="+n+"]").addClass("active")}}),p=new(c.a.RoutedRoot.extend({render:function(){return this.$el.append(DIV({class:"row"},DIV({class:"col-md-3"},DIV({id:"sidebar",class:"list-group"},A({class:"list-group-item",href:"#general","data-action-param":"general"},Object(i.a)("l_general"),I({class:"fa fa-chevron-right right"})),A({class:"list-group-item",href:"#actions","data-action-param":"actions"},Object(i.a)("l_actions"),I({class:"fa fa-chevron-right right"})),A({class:"list-group-item",href:"#devices","data-action-param":"devices"},Object(i.a)("l_devices"),I({class:"fa fa-chevron-right right"})),A({class:"list-group-item",href:"https://distill.io/settings/emails_phones"},Object(i.a)("l_emails_phones"),I({class:"fa fa-chevron-right right"})),A({class:"list-group-item",href:"#advanced","data-action-param":"advanced"},Object(i.a)("l_advanced"),I({class:"fa fa-chevron-right right"})))),this.body=DIV({class:"col-md-9"}))),this}}))({el:R("#content")[0]}).render();R("<div id='x-vsidebar'></div>").appendTo(document.body),Object(n.b)(Object(L.a)(),document.getElementById("x-vsidebar")),R("#x-vsidebar").find('[data-toggle="tooltip"]').tooltip({placement:"right"}),R("#x-vsidebar").find(".vbar-tooltip").tooltip({placement:"right"}),window.App=new f,App.clients=new u.a.Clients,App.clients.defaultId=s.a.store.Prefs.get("client.id"),p.on("child:add child:remove",_.debounce((function(){l.a.Acts.setActions(p.getActions())}),100)),R((function(){d.a.init((function(e,t){if(e)throw r.a.stop("init",{error:{msg:"err:api_load"}}),new Error("Failed to init api subsystem:"+e);r.a.stop("init"),App.clients.fetch({data:{"state.in":[0,30],_opt:{order:["ts"]}}}),F.history.start({root:ROUTE_ROOT,pushState:PUSH_STATE}),r.a.showHelp()}))}))}},72:function(e,t,a){"use strict";var n=a(0),i=window.jQuery;if(!i)throw new Error("ADD jQuery");t.a=function(){i("[data-placeholder]").each((function(){this.placeholder=Object(n.a)(this.getAttribute("data-placeholder"))})),i("[data-text]").each((function(){this.textContent=Object(n.a)(this.getAttribute("data-text"))})),i("[data-title]").each((function(){this.title=Object(n.a)(this.getAttribute("data-title"))}))}},76:function(e,t,a){"use strict";var n=a(2).a.CFG.URL.ROOT;t.a={api:"".concat(n,"/api/v1"),static:"/ui",error_reporter:"https://reporter.distillweb.net",error_reporter_local:"error-reporter-local",website:"https://distill.io",watchlist:"/ui/inbox.html#inbox",template:"/ui/inbox.html#tpls",availability:"".concat(n,"/analytics/availability"),settings:"/ui/settings.html#general",billing:"".concat(n,"/settings/billing"),login:"".concat(n,"/service-login?redirect=app://ui/inbox.html#inbox"),logout:"".concat(n,"/logout")}},77:function(e,t,a){"use strict";var n=a(0),i=a(4),o=a(10),s=window._;if(!s)throw new Error("ADD _");var l=window.Backbone;if(!l)throw new Error("ADD Backbone");var r=window.jQuery;if(!r)throw new Error("ADD jQuery");if(!window.domo)throw new Error("ADD domo");var c=i.a.Base.extend({name:"FeedbackForm",events:{"click button":"send_feedback","change input":"event_change","keypress textarea":"event_change"},event_change:function(e){var t=this;s.defer((function(){var a=e.target,n=a.name,i=a.value;i=i.trim(),t.model.set(n,i)}))},send_feedback:function(e){var t=this;e.preventDefault();var a=this.model.get("message"),n=this.model.get("emotion"),i=document.URL;a&&(o.a.api("/feedbacks","POST",{message:a,emotion:n,context:i},(function(e){})),r(this.form).addClass("hide").removeClass("form"),r(this.success).removeClass("hide"),window.setTimeout((function(){t.hide()}),2e3),this.model.set({message:"",emotion:"😀"}))},hide:function(){r(window).off("mousedown",this.onAClick).off("keypress",this.onKeyup),this.remove()},removeChildren:function(){s.each(this.children.slice(0),(function(e){e.remove(),this.trigger("child:remove")}),this)},onAClick:function(e){var t=e.target;!r.contains(document.documentElement,t)&&document.documentElement!=t||r.contains(this.form,t)||this.hide()},onKeyup:function(e){console.log(e.keyCode),27==e.keyCode&&this.hide()},postInit:function(){s.defer((function(e){r(window).mousedown(e.onAClick).keyup(e.onKeyup)}),this)},render:function(){var e=this;return this.$el.append(DIV({class:"popover",style:"display: flex;\n        flex-wrap:wrap;\n        text-align:center;\n        top: auto;\n        left: 60px;\n        bottom: 50px;\n        width: 300px"},this.form=FORM({class:"form",role:"form"},TEXTAREA({type:"text",name:"message",placeholder:Object(n.a)("m_send_feedback"),style:"width: 100%; height: 120px; padding: 5px 10px 10px"},this.model.get("message")||""),DIV({style:"margin:0px 0px 2px 0px; width:auto;",class:"btn-group btn-group-toggle","data-toggle":"buttons"},s.map([{emo:"😀",title:Object(n.a)("l_happy")},{emo:"🤔",title:Object(n.a)("l_suggestion")},{emo:"☹",title:Object(n.a)("l_sad")},{emo:"🙄",title:Object(n.a)("l_confused")},{emo:"😡",title:Object(n.a)("l_dissatisfied")}],(function(t){return LABEL({class:"btn btn-secondary "+(t.emo==e.model.get("emotion")?"active":""),title:t.title},INPUT({type:"radio",value:t.emo,name:"emotion"}),t.emo)}))),BUTTON({type:"submit",class:"btn btn-primary pull-right ",style:"min-width:0"},Object(n.a)("a_send"))),this.success=DIV({class:"hide",style:"width:100%; ma-width: 30%; margin:20% 30%; "},Object(n.a)("m_thank_you"),"       😀"))),this.focus(),this}}),d=i.a.Base.extend({name:"FeedbackAnchor",events:{"click a":"event_click"},postInit:function(){this.model=new l.Model({emotion:"😀"})},event_click:function(){var e=new c({model:this.model,parent:this}).render();r(this.popoverCt).append(e.el)},render:function(){return this.$el.append(A({class:"ripple",id:"feedAnchor",href:"#","data-toggle":"tooltip","data-html":"true",title:"<b>Feedback</b>"},I({class:"fa fa-comment","aria-hidden":"true"})),this.popoverCt=DIV({id:"feedPop"})),this}});t.a={FeedbackAnchor:d}},78:function(e,t,a){"use strict";var n=a(2),i=(a(0),a(9)),o=a(4),s=[{locale:"en-US",label:"English (US)"},{locale:"de",label:"Deutsch"},{locale:"fr",label:"Français"},{locale:"ru",label:"Русский"},{locale:"ja",label:"日本語"},{locale:"zh",label:"简体中文"},{locale:"es",label:"Español"},{locale:"it",label:"Italiano"},{locale:"pl",label:"Polskie"},{locale:"pt",label:"Português do Brasil"},{locale:"sr",label:"Српски"}],l=a(10),r=window._;if(!r)throw new Error("ADD _");if(!window.jQuery)throw new Error("ADD jQuery");var c=window.location,d=o.a.Dropdown.extend({getLocale:function(){return USER&&USER.locale||LOCALE},getLabel:function(e){return r.findWhere(s,{locale:e}).label},postInit:function(e){this.menu=new o.a.Menu({items:r.map(s,(function(e){return{label:e.label,data:{locale:e.locale}}}))}),this.menu.on("click",this.onClick),this.setLabel(""),this.$el.attr({"data-toggle":"tooltip","data-html":"true",title:"<b>Language</b>"})},onClick:function(e){var t=e.locale;if(i.a.agents.local){var a=n.a.auth.getId();n.a.store.Prefs.set("locale",t),a?l.a.api("/users","PUT",{id:a,locale:t},(function(){n.a.service.SyncMan._syncStore(n.a.store.UserStore,(function(){c.reload()}))})):c.reload()}else USER&&l.a.api("/users","PUT",{locale:t},(function(){c.reload()}));return!0},renderAction:function(){return A({class:"ripple vbar-tooltip",href:"#","data-toggle":"dropdown","data-html":"true"},I({class:"fa fa-language","aria-hidden":"true"}))}});t.a=d},79:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(24),i=a.n(n),o=a(2),s=a(9),l=a(21),r=a(77),c=a(78),d=a(0),u=a(76);function h(){var e=i()(["<li role='presentation'><a href=\"/admin/users\" role='menuitem'>","</a></li>"]);return h=function(){return e},e}function f(){var e=i()(["<li role='presentation'><a href=\"",'" target="_blank" role=\'menuitem\'>',"</a></li>"]);return f=function(){return e},e}function p(){var e=i()(["\n                  <li class='login' role='presentation'><a href="," role='menuitem'>","</a></li>\n                "]);return p=function(){return e},e}function m(){var e=i()(["\n                  <li class='logout' role='presentation'><a href="," @click="," role='menuitem'>"," (<em>","</em>)</a></li>\n                "]);return m=function(){return e},e}function v(){var e=i()(['\n            <a class=\'xripple\' href=\'/groups/\' data-toggle="tooltip" data-html="true" title="<b>Manage Teams</b>">\n              <i class="fa fa-users" aria-hidden="true"></i>\n            </a>']);return v=function(){return e},e}function b(){var e=i()(["\n    <div class='vbar'>\n        <a class='xripple xside-logo' target=\"_blank\" rel=\"noopener\" href='",'\' data-toggle="tooltip" data-html="true" title="<b>Distill.io</b>"><img height=38 alt=\'distill-logo\' src=\'',"/img/distill_logo_inverted.svg'/></a>\n        <a class='xripple' href='",'\' data-toggle="tooltip" data-html="true" title="<b>Watchlist</b>"><i class="fa fa-list" aria-hidden="true"></i></a>\n        <a class=\'xripple\' href=\'','\' data-toggle="tooltip" data-html="true" title="<b>Analytics</b>"><i class="fa fa-bar-chart-o" aria-hidden="true"></i></a>\n        <a class=\'xripple\' href=\'','\' data-toggle="tooltip" data-html="true" title="<b>Templates</b>"><i class="fa fa-file-text" aria-hidden="true"></i></a>\n        ',"\n        <i style='flex: 1'></i>\n        ","\n        ",'\n        <div class=\'dropdown\' data-toggle="tooltip" data-html="true" title="<b>Settings</b>">\n            <a class=\'xripple vbar-tooltip dropdown-toggle\' data-toggle="dropdown" href=\'#\'>\n              <i class="fa fa-cog" aria-hidden="true"></i>\n            </a>\n            <ul class=\'dropdown-menu\' role=\'menu\'>\n              ','\n              <li class=\'divider\'></li>\n              <li><a target="_blank" rel="noopener" href="https://distill.io/kb/">',"</a></li>\n              <li role='presentation'><a href=\"","\" role='menuitem'>","</a></li>\n              ","\n              ","\n            </ul>\n        </div>\n    </div>\n  "]);return b=function(){return e},e}window._;if(!window.jQuery)throw new Error("ADD jQuery");var g=(new c.a).render(),w=(new r.a.FeedbackAnchor).render();function _(e){s.a.agents.local&&(e.preventDefault(),o.a.auth.logout(),location.href=u.a.logout)}function O(){return Object(l.b)(b(),u.a.website,u.a.static,u.a.watchlist,u.a.availability,u.a.template,USER.account_id?Object(l.b)(v()):"",w.el,g.el,USER.name?Object(l.b)(m(),u.a.logout,_,Object(d.a)("a_sign_out"),USER.name):Object(l.b)(p(),u.a.login,Object(d.a)("a_signin")),Object(d.a)("l_support"),u.a.settings,Object(d.a)("l_settings"),USER.account_id?"":Object(l.b)(f(),u.a.billing,Object(d.a)("l_billing")),"admin"==USER.role?Object(l.b)(h(),Object(d.a)("l_admin")):"")}}}]);
//# sourceMappingURL=13.js.map